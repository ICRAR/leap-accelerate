Adapted code from WSClean Repository
